---
title: "Traitement du biais de sélection dans les enquêtes multimodes séquentielles"
author: "Odilon Saint-Cry DAKPAKETE, Marius DURAND-BARRIER, Ilyass MESSABEL & TANO
  Anoumou Marc "
date: "2025-02-12"
output:
  pdf_document:
    number_sections: true
    toc: true
  html_document:
    toc: true
    df_print: paged
header-includes:
- \usepackage{amsmath}
- \usepackage{amsfonts}
- \usepackage{amssymb}
- \usepackage{graphicx}
- \usepackage{float}
- \usepackage{titling}
- \pretitle{\begin{center}\LARGE\bfseries\vspace{5cm}}
- \posttitle{\par\end{center}\vspace{1cm}}
- \preauthor{\begin{center}\LARGE}
- \postauthor{\par\end{center}\vspace{10cm}}
- \newpage
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if (!requireNamespace("pacman", quietly = TRUE)) install.packages("pacman")

pacman::p_load(tibble, DT, tidyverse, tidymodels, skimr, rsample, kernlab, ggplot2, readr,
               gtsummary,MASS,simstudy, dplyr)

# install.packages("xfun")
# update.packages(ask = FALSE) # Mise à jour des packages R
# install.packages("xfun", dependencies = TRUE)
# utils::install.packages(c("tinytex", "rmarkdown"))
# utils::contrib.url(repos, "source")
```

\newpage
# Introduction

Le processus de réalisation d’une enquête repose sur plusieurs étapes essentielles, telles que la formulation de la problématique, la conception des questionnaires, la mise en œuvre de la collecte des données et leur suivi. Chacune de ces phases peut générer des erreurs en l'absence d'une méthode rigoureuse. L'ensemble de ces erreurs constitue l'erreur totale de l'enquête.

Certaines erreurs proviennent de l'administration du questionnaire, c'est-à-dire des difficultés liées aux différents modes de collecte des données. Ce problème se manifeste particulièrement dans les enquêtes multimodes, qui combinent divers supports (Internet, téléphone, face-à-face, papier) afin d'optimiser le taux de réponse tout en maîtrisant les coûts.

Le développement rapide des technologies numériques a favorisé l'émergence des enquêtes multimodes, transformant ainsi les méthodes de collecte de données. L'utilisation simultanée de plusieurs modes permet de mieux répondre aux besoins d'une population de plus en plus diversifiée, tout en soulevant d'importants défis méthodologiques. Par exemple, le protocole séquentiel, souvent utilisé, propose d'abord un mode de collecte (généralement Internet), suivi d'un mode complémentaire (téléphone ou face-à-face) en cas de non-réponse. Bien que cette stratégie permette de maîtriser les coûts et d'augmenter le taux de réponse, elle expose l'enquête à deux types de biais majeurs :

  - Le biais de sélection survient lorsque la probabilité de participation dépend directement de la variable d'intérêt (Y). Ainsi, le profil des répondants peut varier selon le mode de collecte, ce qui complique l'interprétation des résultats et limite l'efficacité des méthodes classiques de redressement.

  - Le biais de mesure se traduit par des réponses divergentes d'un même individu selon le mode de collecte utilisé. Par exemple, lors d'une enquête téléphonique, un répondant peut être tenté d'ajuster ses réponses pour se conformer aux normes sociales, contrairement à ce qu'il ferait dans un questionnaire auto-administré.

Ce projet se concentre sur le biais de sélection dans le cadre d'une enquête multimode séquentielle combinant Internet et téléphone. Plus précisément, il vise à tester, au moyen de simulations de données, la validité des méthodes classiques de redressement en présence d'un biais de non-réponse non-ignorable. L'objectif est de déterminer jusqu'à quel point ces méthodes restent efficaces et à partir de quel seuil l'influence des variables non observables (U) compromet leur performance.

![Le processus schématisé de l’enquête](schemat.png)

\newpage

# Concept théorique 

Dans ce projet, nous faisons l’hypothèse que Y est une variable numérique et nous cherchons à estimer sa moyenne ($\mu$). Étant donné que nous sommes dans un cadre de simulation, nous disposons de l’ensemble des valeurs $Y_{i}$ de la population simulée. La moyenne réelle de Y est alors définie par la formule suivante :

$$\mu = \frac{1}{N}\sum_{i=1}^N Y_{i}$$

Nous réalisons ensuite plusieurs simulations à partir de cet échantillon total, en tenant compte de la présence de non-réponse. Dans ces cas, certaines valeurs $Y_{i}$, restent inconnues, ce qui nous oblige à estimer la moyenne. Comme mentionné dans Castell & Sillard (2021), le plan de sondage est défini par le vecteur  $S = (s_{1}, s_{2}, ..., s_{N})$ , où chaque $s_{i}$ est une variable aléatoire prenant la valeur 1 si l’individu i est sélectionné dans l’échantillon, et 0 sinon.


L’estimateur d’Horvitz-Thompson de la moyenne de Y est alors donné par :

$$\hat{\mu} = \frac{1}{N}\sum_{i=1}^N \frac{y_{i}}{\pi_{i}}s_{i}$$
Cet estimateur est sans biais, car $\mathbb{E}[s_{i}] = \pi_{i}$, ce qui implique  $\mathbb{E}[\hat{\mu}|y] = \mu$

Toutefois, dans notre étude, l’enquête est réalisée en mode séquentiel (Internet, puis téléphone). Si l’on applique une pondération classique sans distinction des modes de collecte, l’estimateur s’écrit : 

$$\hat{\mu_{1}} = \frac{1}N\sum_{i=1}^N \frac{y_{i}}{\pi_{i}}s_{i}r_{i} $$
où $r_{i}$ est une variable indiquant si l’individu a répondu à l’enquête.
Cependant, si l’on utilise une approche multiplicative qui distingue les modes de collecte, nous devons introduire deux indicatrices :

  - $z_{i}$ : variable aléatoire valant 1 si l’individu i répond par Internet, 0 sinon.

  - $w_{i}$  : variable aléatoire valant 1 si l’individu i répond par téléphone, 0 sinon.

On définit alors $r_{i} = (z_{i}+w_{i})$, et les vecteurs Z et W permettent d’identifier les répondants selon leur mode de réponse. L’estimateur devient :

$$\hat{\mu_{1}} = \frac{1}N\sum_{i=1}^N \frac{y_{i}}{\pi_{i}}s_{i}(z_{i}+w_{i}) = \frac{1}N \left(\sum_{i=1}^N \frac{y_{i}}{\pi_{i}}s_{i}z_{i} + \sum_{i=1}^N \frac{y_{i}}{\pi_{i}}s_{i}w_{i}\right)$$

Cet estimateur est biaisé, car selon Castell & Sillard (2021), $\mathbb{E}[s_{i}(z_{i}+w_{i})]\ne \pi_{i}$


Pour corriger ce biais, nous introduisons $\hat\rho_{1}$ et $\hat\rho_{2}$, qui modélisent respectivement $z_{i}$ et de $w_{i}$, de manière à garantir que $\mathbb{E}[\hat{\mu_{2}}|y] = \mu$. Nous estimons donc $\hat\rho_{1}$ et $\hat\rho_{2}$ de sorte que l’estimateur corrigé soit :

$$\hat{\mu_{2}} = \frac{1}N \left(\sum_{i=1}^N \frac{y_{i}}{\pi_{i}\hat\rho_{1}}s_{i}z_{i} + \sum_{i=1}^N \frac{y_{i}}{\pi_{i}\hat\rho_{2}}s_{i}w_{i}\right)$$


# Simulation

## Variables simulées

La mise en place d’un cadre de simulation rigoureux repose sur la maîtrise des corrélations entre les différentes variables. Trois types de variables sont simulées, à savoir:


– **Variables représentant la probabilité de réponse selon le mode de collecte**

  - Pi: probabilité de répondre sur Internet 
  - Pt: probabilité de répondre au téléphone

– **Variable d’intérêt de l’enquête**

  - Y : variable cible de l’enquête, observée uniquement pour les répondants.Elle est expliquée par X0 et X1, mais aussi U. 

– **Variables explicatives**

  - X0: variable auxiliaire disponible pour l’ensemble des répondants et non-répondants.
  - X1: variable sociodémographique disponible uniquement pour les répondants. 
    - U: variable instrumentale non observée influençant simultanément la probabilité de réponse par Internet, par téléphone et la valeur de Y. Cette variable est simulée aussi bien pour les répondants que pour les non-répondants.

Nous faisons ensuite varier la corrélation entre ces variables afin d’évaluer l’impact du biais dans l’estimation de Y.

La matrice de corrélation utilisée pour la simulation est la suivante :

....

Enfin, nous représentons les distributions des variables simulées à l’aide d’histogrammes pour mieux visualiser leurs caractéristiques.


## Histogramme des variables simulées 


## Simulation de l’échantillon et des répondants

Une population simulée d’un million d’individus sert de base à l’étude. Un échantillon aléatoire de 10 000 individus est ensuite extrait pour l’enquête.  

La réponse par internet est déterminée en comparant, pour chaque individu, sa probabilité de réponse \( p_{\text{internet}} \) à un seuil aléatoire : si \( p_{\text{internet}} \) dépasse ce seuil, l’individu répond, sinon il est reclassé comme non-répondant. Ces non-répondants sont ensuite sollicités par téléphone, suivant le même principe avec un seuil distinct. Ceux qui ne répondent à aucun des deux modes sont considérés comme absents de l’enquête.  

Chaque individu se voit attribuer un seuil tiré d’une loi uniforme \( U(0,1) \). Il est considéré comme répondant si sa probabilité de réponse dépasse ce seuil. Cette approche assure que le comportement simulé reflète fidèlement les probabilités de réponse définies.  

Le taux de réponse par mode est obtenu en faisant la moyenne des probabilités de réponse : pour Internet, sur l’ensemble de l’échantillon ; pour le téléphone, sur les non-répondants Internet.


# correction des biais de selection
Dans notre cas, il s'agit de traiter le biais de non-réponse non-ignorable. Pour cela, nous allons utiliser les méthodes de redressement suivantes :

```{r, echo=FALSe, message=FALSE, warning=FALSE}
# Fonction de simulation de la population
simul_popF <- function(n, mu, var, corMat){
    # Définition des distributions des variables X0, X1 et U
    def = defData(varname = "X0", dist = "normal", formula = mu[1], variance = var[1])
    def = defData(def, varname = "X1", dist = "normal", formula = mu[2], variance = var[2])
    def = defData(def, varname = "U", dist = "normal", formula = mu[3], variance = var[3])
    def = defData(def, varname = "Pi", dist = "uniform", formula = "0;1")
    def = defData(def, varname = "Pt", dist = "uniform", formula = "0;1")
    
    # Correction de la matrice pour la rendre définie positive
    corMat <- as.matrix(nearPD(corMat)$mat)
    
    don <- genCorData(n, mu = mu, sigma = sigma, corMatrix = corMat, 
                       cnames = c("X0", "X1", "U", "Pi", "Pt"))
    
    # Définition de Y en fonction de X0, X1 et U
    don[, Y := 0.5 * X0 + 0.3 * X1 + 0.7 * U + rnorm(.N, 0, 1)]
    
    # Suppression des variables intermédiaires
    don <- don[, .(X0, X1, U, Pi, Pt, Y)]
    
    return(don)
}
```


```{r echo=FALSe, message=FALSE, warning=FALSE}
corMat <- matrix(c(1, .3, .2, .1, .1,  
                   .3, 1, .4, .2, .1,  
                   .2, .4, 1, .6, .7,  
                   .1, .2, .6, 1, .4,  
                   .1, .1, .7, .4, 1), 
                 nrow = 5, byrow = TRUE)

mu <- c(0, 3, 5, 0.5, 0.4)
sigma <- c(6, 2, 1, .1, .2)
n <- 1000

don <- simul_popF(n, mu, sigma, corMat)
```



```{r echo=FALSe, message=FALSE, warning=FALSE}
don |> pivot_longer(cols = names(don), names_to = "Variables", values_to = "Valeurs") |> 
  ggplot(aes(x = Valeurs, fill = Variables)) +
  geom_histogram(bins = 30, alpha = 0.7, position = "identity") +
  facet_wrap(~Variables, scales = "free") +
  theme_minimal()
```

